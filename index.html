<!-- EmailJS SDK v4 -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  emailjs.init("r50mzNs4DLHf_pWzK");

  const prixPlats = { "Hamburger": 5, "Frites": 2 };
  const prixBoissons = { "Coca Cola": 1, "Sprite": 1, "Jupiler": 1.5 };

  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById("order-form");

    document.getElementById("plat").addEventListener("change", updateTotal);
    document.getElementById("boisson").addEventListener("change", updateTotal);

    function updateTotal() {
      const plat = document.getElementById('plat').value;
      const boisson = document.getElementById('boisson').value;
      let total = 0;
      if (plat) total += prixPlats[plat];
      if (boisson) total += prixBoissons[boisson];
      document.getElementById('total').textContent = `Prix total : ${total}€`;
    }

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const nom = document.getElementById("nom").value;
      const plat = document.getElementById("plat").value;
      const boisson = document.getElementById("boisson").value;
      const total = prixPlats[plat] + prixBoissons[boisson];
      const code = Math.floor(100000 + Math.random() * 900000);
      const now = new Date();
      const date = now.toLocaleDateString('fr-FR');
      const time = now.toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' });

      const params = {
        name: nom,
        order: `${plat} + ${boisson}`,
        date: date,
        time: time,
        "cost.total": total,
        order_id: code
      };

      emailjs.send("service_q67jhal", "template_g66jtml", params)
        .then(() => {
          // ✅ Redirection vers page de confirmation
          window.location.href = "confirmation.html";

          // OU afficher un message sur la même page :
          // document.body.innerHTML = `<h1>Merci ${nom}, votre commande a été envoyée !</h1>`;
        })
        .catch((error) => {
          alert("Erreur lors de l'envoi de l'email : " + error.text);
        });
    });
  });
</script>







